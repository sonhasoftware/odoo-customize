<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="template_report_month" t-name="sonha_kpi.template_report_month">
        <t t-call="web.html_container">
            <div class="page">
                <style>
                    th, td {
                        border: 1px solid #000;
                        text-align: center;
                        vertical-align: middle;
                        padding:5px;
                        min-width: 50px;
                        max-width: 500px;
                    }
                    th {
                        background-color: #CCFFFF;
                    }
                    body {
                        font-family: "Arial";
                    }
                    thead {
                        position: sticky;
                        top: 0;
                    }
                    td.left {
                        text-align: left;
                    }
                    .custom{
                        text-align: left;
                    }
                    .total-class {
                        display: flex;
                        justify-content: space-between;
                        margin: 25px;
                    }
                    .sum{
                        background-color: #66FF66;
                        padding: 10px;
                    }
                </style>
                <t t-if="docs">
                    <t t-set="doc0" t-value="docs[0]" />
                    <div style="margin-top: 20px;">
                        <a t-attf-href="/kpi/report/month/export/excel?department_id={{ doc0.department_id.id }}&amp;year={{ doc0.year }}&amp;month={{ doc0.start_date.month }}"
                           class="btn btn-primary">
                           üì• T·∫£i Excel
                    </a>
                    </div>
                <table>
                    <thead>
                        <tr>
                            <th rowspan="2">N·ªòI DUNG C√îNG VI·ªÜC <br/>(ƒê√£ giao ·ªü m·ª•c ti√™u/ KPIs c·∫£ nƒÉm)</th>
                            <th rowspan="2">N·ªòI DUNG C√îNG VI·ªÜC C·ª§ TH·ªÇ</th>
                            <th colspan="2">TH·ªúI GIAN TH·ª∞C HI·ªÜN</th>
                            <th rowspan="2">TI√äU CH√ç ƒê√ÅNH GI√Å R√öT G·ªåN</th>
                            <th rowspan="2">T·ª∑ tr·ªçng</th>
                            <th rowspan="2">ƒêi·ªÉm chu·∫©n</th>
                            <th rowspan="2">M√î T·∫¢ CHI TI·∫æT C√îNG VI·ªÜC/ KI·∫æN NGH·ªä ƒê·ªÄ XU·∫§T C·ª¶A ƒê∆†N V·ªä</th>
                            <th colspan="3">Œ£ ƒêI·ªÇM ƒê∆†N V·ªä ƒê√ÅNH GI√Å</th>
                            <th colspan="3">Œ£ ƒêI·ªÇM C·∫§P THAM QUY·ªÄN ƒê√ÅNH GI√Å</th>
                            <th rowspan="2">NH·∫¨N X√âT C·ª¶A C·∫§P C√ì TH·∫®M QUY·ªÄN</th>
                        </tr>
                        <tr>
                            <th>B·∫Øt ƒë·∫ßu</th>
                            <th>Ho√†n th√†nh</th>
                            <th>K·∫øt qu·∫£ ho√†n th√†nh</th>
                            <th>ƒêi·ªÉm ƒë·∫°t</th>
                            <th>ƒêi·ªÉm quy ƒë·ªïi theo t·ª∑ tr·ªçng</th>
                            <th>K·∫øt qu·∫£ ho√†n th√†nh</th>
                            <th>ƒêi·ªÉm ƒë·∫°t</th>
                            <th>ƒêi·ªÉm quy ƒë·ªïi theo t·ª∑ tr·ªçng</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="docs" t-as="doc">
                            <tr>
                                <td rowspan="2" style="font-weight: bold;" class="left"><t t-esc="doc.name.name"/></td>
                                <td rowspan="2" class="left"><t t-esc="doc.content_detail"/></td>
                                <td rowspan="2"><t t-esc="doc.converted_start_date"/></td>
                                <td rowspan="2"><t t-esc="doc.converted_end_date"/></td>
                                <td class="left">Kh·ªëi l∆∞·ª£ng c√¥ng vi·ªác th·ª±c hi·ªán</td>
                                <td rowspan="2"><t t-esc="round(doc.ti_trong * 100, 1)"/>%</td>
                                <td><t t-esc="round(doc.diem_chuan_amount_work, 1)"/></td>
                                <td rowspan="2" class="custom"><t t-esc="doc.dv_description"/></td>

                                <td><t t-esc="round(doc.kq_hoan_thanh_amount_work * 100, 1)"/>%</td>
                                <td><t t-esc="round(doc.diem_dat_dv_amount_work, 1)"/></td>
                                <td><t t-esc="round(doc.quy_doi_dv_amount_work, 1)"/></td>
                                <td><t t-esc="round(doc.kq_hoan_thanh_tq_amount_work * 100, 1)"/>%</td>
                                <td><t t-esc="round(doc.diem_dat_tq_amount_work, 1)"/></td>
                                <td><t t-esc="round(doc.quy_doi_tq_amount_work, 1)"/></td>
                                <td rowspan="2" class="custom"><t t-esc="doc.note"/></td>
                            </tr>
                            <tr>
                                <td class="left">Ch·∫•t l∆∞·ª£ng c√¥ng vi·ªác th·ª±c hi·ªán</td>
                                <td><t t-esc="round(doc.diem_chuan_matter_work, 1)"/></td>
                                <td><t t-esc="round(doc.kq_hoan_thanh_matter_work * 100, 1)"/>%</td>
                                <td><t t-esc="round(doc.diem_dat_dv_matter_work, 1)"/></td>
                                <td><t t-esc="round(doc.quy_doi_dv_matter_work, 1)"/></td>
                                <td><t t-esc="round(doc.kq_hoan_thanh_tq_matter_work * 100, 1)"/>%</td>
                                <td><t t-esc="round(doc.diem_dat_tq_matter_work, 1)"/></td>
                                <td><t t-esc="round(doc.quy_doi_tq_matter_work, 1)"/></td>
                            </tr>
<!--                            <tr>-->
<!--                                <td class="left">Ch·∫•p h√†nh n·ªôi quy, quy ch·∫ø, k·ª∑ lu·∫≠t lao ƒë·ªông</td>-->
<!--                                <td><t t-esc="round(doc.diem_chuan_comply_regulations, 1)"/></td>-->
<!--                                <td><t t-esc="round(doc.kq_hoan_thanh_comply_regulations * 100, 1)"/>%</td>-->
<!--                                <td><t t-esc="round(doc.diem_dat_dv_comply_regulations, 1)"/></td>-->
<!--                                <td><t t-esc="round(doc.quy_doi_dv_comply_regulations, 1)"/></td>-->
<!--                                <td><t t-esc="round(doc.kq_hoan_thanh_tq_comply_regulations * 100, 1)"/>%</td>-->
<!--                                <td><t t-esc="round(doc.diem_dat_tq_comply_regulations, 1)"/></td>-->
<!--                                <td><t t-esc="round(doc.quy_doi_tq_comply_regulations, 1)"/></td>-->
<!--                            </tr>-->
<!--                            <tr>-->
<!--                                <td class="left">C·∫£i ti·∫øn, ƒë·ªÅ xu·∫•t, s√°ng ki·∫øn</td>-->
<!--                                <td><t t-esc="round(doc.diem_chuan_initiative, 1)"/></td>-->
<!--                                <td><t t-esc="round(doc.kq_hoan_thanh_initiative * 100, 1)"/>%</td>-->
<!--                                <td><t t-esc="round(doc.diem_dat_dv_initiative, 1)"/></td>-->
<!--                                <td><t t-esc="round(doc.quy_doi_dv_initiative, 1)"/></td>-->
<!--                                <td><t t-esc="round(doc.kq_hoan_thanh_tq_initiative * 100, 1)"/>%</td>-->
<!--                                <td><t t-esc="round(doc.diem_dat_tq_initiative, 1)"/></td>-->
<!--                                <td><t t-esc="round(doc.quy_doi_tq_initiative, 1)"/></td>-->
<!--                            </tr>-->
                        </t>
                    </tbody>
                </table>
                </t>
                <t t-else="">
                    <h1>Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ hi·ªÉn th·ªã</h1>
                </t>
                <div class="total-class">
                    <t t-set="months" t-value="set([d.start_date.month for d in docs])"/>
                    <t t-if="len(months) == 1">
                        <div class="sum">
                            <t t-set="total_points" t-value="round(sum(docs.mapped('quy_doi_dv_amount_work')) + sum(docs.mapped('quy_doi_dv_matter_work')), 1)"/>
                            <t t-if="total_points > 100" t-set="classification" t-value="'Xu·∫•t s·∫Øc'"/>
                            <t t-elif="total_points > 90" t-set="classification" t-value="'T·ªët'"/>
                            <t t-elif="total_points > 75" t-set="classification" t-value="'Kh√°'"/>
                            <t t-elif="total_points > 65" t-set="classification" t-value="'Ho√†n th√†nh'"/>
                            <t t-elif="1 > total_points" t-set="classification" t-value=""/>
                            <t t-else="">
                                <t t-set="classification" t-value="'C·∫ßn c·ªë g·∫Øng'"/>
                            </t>
                            <h4>ƒê∆°n v·ªã ƒë√°nh gi√°</h4>
                            <h5>T·ªïng ƒëi·ªÉm: <t t-esc="total_points"/></h5>
                            <h5>X·∫øp lo·∫°i: <t t-esc="classification"/></h5>
                        </div>
                        <div class="sum">
                            <t t-set="tq_total_points" t-value="round(sum(docs.mapped('quy_doi_tq_amount_work')) + sum(docs.mapped('quy_doi_tq_matter_work')), 1)"/>
                            <t t-if="tq_total_points > 100" t-set="tq_classification" t-value="'Xu·∫•t s·∫Øc'"/>
                            <t t-elif="tq_total_points > 90" t-set="tq_classification" t-value="'T·ªët'"/>
                            <t t-elif="tq_total_points > 75" t-set="tq_classification" t-value="'Kh√°'"/>
                            <t t-elif="tq_total_points > 65" t-set="tq_classification" t-value="'Ho√†n th√†nh'"/>
                            <t t-elif="1 > tq_total_points" t-set="tq_classification" t-value=""/>
                            <t t-else="">
                                <t t-set="tq_classification" t-value="'C·∫ßn c·ªë g·∫Øng'"/>
                            </t>
                            <h4>C·∫•p th·∫©m quy·ªÅn ƒë√°nh gi√°</h4>
                            <h5>T·ªïng ƒëi·ªÉm: <t t-esc="tq_total_points"/></h5>
                            <h5>X·∫øp lo·∫°i: <t t-esc="tq_classification"/></h5>
                        </div>
                    </t>
                </div>
            </div>
        </t>
    </template>
</odoo>
